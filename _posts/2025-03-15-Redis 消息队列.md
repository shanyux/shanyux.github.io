---
layout:     post
title:      Redis 消息队列
date:       2025-03-15
author:     KevinShan
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - Redis
---

####  1. List

缺点：
1. 不支持重复消费：消费者拉取消息后，这条消息就从 List 中删除了，无法被其它消费者再次消费，即不支持多个消费者消费同一批数据，不能满足多组生产者和消费者的业务场景。
2. 消息丢失：消费者拉取到消息后，如果发生异常宕机，那这条消息就丢失了。另外无论一条消息，消费者是否处理成功，这条消息都没办法再次消费了

#### 2. 发布/订阅模型：Pub/Sub

消息模型有两种

* 点对点：Point-to-Point(P2P)   List 实现方式其实就是点对点的模式
* 发布订阅：Publish/Subscribe(Pub/Sub)

1. 支持发布 / 订阅，支持多组生产者、消费者处理消息
2. 消费者下线，数据会丢失
3. 不支持数据持久化，Redis 宕机，数据也会丢失
4. 消息堆积，缓冲区溢出，消费者会被强制踢下线，数据也会丢失

#### 3. Streams

特点：
* 支持阻塞等待拉取消息
* 支持发布 / 订阅模式
* 消费失败，可重新消费，消息不丢失
* 实例宕机，消息不丢失，数据可持久化 (不能完全保证)

Redis 当作队列来使用时，始终面临的 2 个问题：
1. Redis 本身可能会丢数据
2. 面对消息积压，Redis 内存资源紧张

如果你的业务场景足够简单，对于数据丢失不敏感，而且消息积压概率比较小的情况下，把 Redis 当作队列是完全可以的。

而且，Redis 相比于 Kafka、RabbitMQ，部署和运维也更加轻量。

如果你的业务场景对于数据丢失非常敏感，而且写入量非常大，消息积压时会占用很多的机器资源，那么我建议你使用专业的消息队列中间件。

#### 引用

1. [把Redis当作队列来用，真的合适吗？-redis作为队列](https://www.51cto.com/article/659208.html)
2. [Redis 消息队列的三种方案（List、Streams、Pub/Sub）-redis消息队列使用](https://www.51cto.com/article/640335.html)
